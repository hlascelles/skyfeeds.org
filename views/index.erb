<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Future Eclipses</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 20px;
      background-color: #d3d3d3; /* Light gray background */
      background-image: url('https://upload.wikimedia.org/wikipedia/commons/e/e1/FullMoon2010.jpg'); /* Moon image */
      background-size: 100px; /* Smaller moon */
      background-repeat: no-repeat;
      background-position: top right; /* Top right position */
      background-attachment: fixed;
      color: #333;
    }

    h1, h2, h3 {
      color: #333;
    }

    .btn-ical {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      text-decoration: none;
    }

    .btn-ical:hover {
      background-color: #0056b3;
      color: white;
    }

    .btn-ical i {
      font-size: 1.2em;
    }

    .eclipse-section {
      margin-top: 30px;
      padding: 20px;
      background-color: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
    }

    .eclipse-nav {
      margin-top: 20px;
    }

    table {
      width: 100%;
      margin-top: 15px;
      border-collapse: collapse;
    }

    th, td {
      padding: 8px 12px;
      text-align: left;
      border: 1px solid #ddd;
    }

    th {
      background-color: #f2f2f2;
    }

    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Upcoming Eclipses</h1>

  <!-- Eclipse Calendar Downloads Section -->
  <div class="download-section eclipse-section">
    <h2>Download Eclipse Calendar Files</h2>

    <h3>All Eclipses</h3>
    <a href="combined/combined_eclipse_all.ics" class="btn-ical" target="_blank">
      <i class="bi bi-calendar"></i> All Solar and Lunar Eclipses
    </a>

    <h3>Solar Eclipses</h3>
    <a href="solar/solar_eclipse_all.ics" class="btn-ical" target="_blank">
      <i class="bi bi-calendar"></i> All Solar Eclipses
    </a>
    <div class="mt-2">
      <% solar_types = solar_eclipses.map(&:type).uniq %>
      <% solar_types.each do |type| %>
        <a href="solar/solar_eclipse_<%= type.downcase %>.ics" class="btn-ical" target="_blank">
          <i class="bi bi-calendar"></i> <%= type %> Solar Eclipses
        </a>
      <% end %>
    </div>

    <h3>Lunar Eclipses</h3>
    <a href="lunar/lunar_eclipse_all.ics" class="btn-ical" target="_blank">
      <i class="bi bi-calendar"></i> All Lunar Eclipses
    </a>
    <div class="mt-2">
      <% lunar_types = lunar_eclipses.map(&:type).uniq %>
      <% lunar_types.each do |type| %>
        <a href="lunar/lunar_eclipse_<%= type.downcase %>.ics" class="btn-ical" target="_blank">
          <i class="bi bi-calendar"></i> <%= type %> Lunar Eclipses
        </a>
      <% end %>
    </div>
  </div>

  <!-- Eclipse Navigation Tabs -->
  <div class="eclipse-nav">
    <a href="#solar-eclipses" class="btn btn-primary">Solar Eclipses</a>
    <a href="#lunar-eclipses" class="btn btn-secondary">Lunar Eclipses</a>
  </div>

  <!-- Solar Eclipses Section -->
  <div id="solar-eclipses" class="eclipse-section">
    <h2>Solar Eclipses</h2>

    <!-- List of continents and countries as hyperlinks -->
    <div class="row">
      <div class="col-md-6">
        <h3>Jump to continent:</h3>
        <ul>
          <% continents = solar_eclipses.flat_map(&:continents).uniq.sort %>
          <% continents.each do |continent| %>
            <li><a href="#<%= continent.downcase %>"><%= continent %></a></li>
          <% end %>
        </ul>
      </div>
      <div class="col-md-6">
        <h3>Jump to country:</h3>
        <ul>
          <% countries = solar_eclipses.flat_map(&:countries).uniq.sort %>
          <% countries.each do |country| %>
            <li><a href="#<%= country.downcase.tr(' ', '_') %>"><%= country %></a></li>
          <% end %>
        </ul>
      </div>
    </div>

    <!-- Tables by continent -->
    <% continents.each do |continent| %>
      <h3 id="<%= continent.downcase %>"><%= continent %></h3>
      <a href="solar/<%= continent.downcase %>/solar_eclipse_<%= continent.downcase %>_all.ics" class="btn-ical" target="_blank">
        <i class="bi bi-calendar"></i> Download All <%= continent %> Eclipses
      </a>
      <div class="mt-2">
        <% continent_types = solar_eclipses.select { |e| e.continents.include?(continent) }.map(&:type).uniq %>
        <% continent_types.each do |type| %>
          <a href="solar/<%= continent.downcase %>/solar_eclipse_<%= continent.downcase %>_<%= type.downcase %>.ics" class="btn-ical" target="_blank">
            <i class="bi bi-calendar"></i> <%= type %> Eclipses
          </a>
        <% end %>
      </div>
      <table class="table table-striped mt-3">
        <thead>
        <tr>
          <th>Date</th>
          <th>Time</th>
          <th>Type</th>
          <th>Countries with visibility</th>
        </tr>
        </thead>
        <tbody>
        <% continent_eclipses = solar_eclipses.select { |e| e.continents.include?(continent) } %>
        <% continent_eclipses.each do |eclipse| %>
          <tr>
            <td><%= eclipse.date %></td>
            <td><a href="<%= eclipse.url %>" target="_blank"><%= eclipse.time %></a></td>
            <td><%= eclipse.type %></td>
            <td>
              <% eclipse.countries.each do |country| %>
                <a href="#<%= country.downcase.tr(' ', '_') %>"><%= country %></a>
                <% if country != eclipse.countries.last %>,
                <% end %>
              <% end %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    <% end %>

    <!-- Tables by country -->
    <h2 class="mt-5">Solar Eclipses by Country</h2>
    <% countries.each do |country| %>
      <h3 id="<%= country.downcase.tr(' ', '_') %>"><%= country %></h3>
      <div class="mb-2">
        <% country_str = country.downcase.tr(' ', '_') %>
        <% special_eclipses = solar_eclipses.select { |e| e.countries.include?(country) && (e.type.totalish?) } %>
        <% if special_eclipses.any? %>
          <a href="solar/<%= country_str %>/solar_eclipse_<%= country_str %>_total.ics" class="btn-ical" target="_blank">
            <i class="bi bi-calendar"></i> Total/Hybrid/Annular
          </a>
        <% end %>

        <% partial_eclipses = solar_eclipses.select { |e| e.countries.include?(country) && e.type == Skyfeeds::EclipseType::PARTIAL } %>
        <% if partial_eclipses.any? %>
          <a href="solar/<%= country_str %>/solar_eclipse_<%= country_str %>_partial.ics" class="btn-ical" target="_blank">
            <i class="bi bi-calendar"></i> Partial
          </a>
        <% end %>

        <% all_eclipses = solar_eclipses.select { |e| e.countries.include?(country) } %>
        <% if all_eclipses.any? %>
          <a href="solar/<%= country_str %>/solar_eclipse_<%= country_str %>_all.ics" class="btn-ical" target="_blank">
            <i class="bi bi-calendar"></i> All
          </a>
        <% end %>
      </div>
      <table class="table table-striped mt-3">
        <thead>
        <tr>
          <th>Date</th>
          <th>Time</th>
          <th>Type</th>
          <th>Continents</th>
        </tr>
        </thead>
        <tbody>
        <% country_eclipses = solar_eclipses.select { |e| e.countries.include?(country) } %>
        <% country_eclipses.each do |eclipse| %>
          <tr>
            <td><%= eclipse.date %></td>
            <td><a href="<%= eclipse.url %>" target="_blank"><%= eclipse.time %></a></td>
            <td><%= eclipse.type %></td>
            <td>
              <% eclipse.continents.each do |c| %>
                <a href="#<%= c.downcase %>"><%= c %></a>
                <% if c != eclipse.continents.last %>,
                <% end %>
              <% end %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    <% end %>
  </div>

  <!-- Lunar Eclipses Section -->
  <div id="lunar-eclipses" class="eclipse-section">
    <h2>Lunar Eclipses</h2>

    <h3>Types:</h3>
    <div class="mb-3">
      <a href="lunar/lunar_eclipse_all.ics" class="btn-ical" target="_blank">
        <i class="bi bi-calendar"></i> All Lunar Eclipses
      </a>
      <% lunar_types.each do |type| %>
        <a href="lunar/lunar_eclipse_<%= type.downcase %>.ics" class="btn-ical" target="_blank">
          <i class="bi bi-calendar"></i> <%= type %> Lunar Eclipses
        </a>
      <% end %>
    </div>

    <!-- Table of all lunar eclipses -->
    <table class="table table-striped">
      <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
      </tr>
      </thead>
      <tbody>
      <% lunar_eclipses.each do |eclipse| %>
        <tr>
          <td><%= eclipse.date %></td>
          <td><a href="<%= eclipse.url %>" target="_blank"><%= eclipse.type %></a></td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>
<br>
<br>
<center>
  <h4>Data used with thanks from
    <a href="https://eclipse.gsfc.nasa.gov/SKYCAL/SKYCAL.html">Sky Events Calendar by Fred Espenak
      and Sumit Dutta (NASA's GSFC)</a></h4>
</center>
</body>
</html>
